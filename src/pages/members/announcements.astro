---
import BaseLayout from "../../layouts/BaseLayout.astro";
import { getMemberAnnouncements } from "../../lib/content";
import { render } from "astro:content";

const announcements = await getMemberAnnouncements();
---

<BaseLayout title="Member Announcements - Big Pine Paiute Tribe">
  <h1>Member Announcements</h1>

  <div class="pop-section p-4 mb-4">
    <p class="lead mb-0">
      Important announcements and updates for enrolled tribal members.
    </p>
  </div>

  {announcements.length === 0 ? (
    <div class="pop-section p-4">
      <p class="text-muted mb-0">No announcements at this time.</p>
    </div>
  ) : (
    announcements.map(async (announcement) => {
      const { Content } = await render(announcement);
      return (
        <div class="pop-section p-4 mb-4">
          <div class="d-flex justify-content-between align-items-start">
            <h3>{announcement.data.title}</h3>
            {announcement.data.isNew && (
              <span class="badge bg-primary">New</span>
            )}
          </div>
          <p class="text-muted small">
            Posted: {announcement.data.date.toLocaleDateString("en-US", {
              year: "numeric",
              month: "long",
              day: "numeric",
            })}
          </p>
          <div class="content">
            <Content />
          </div>
        </div>
      );
    })
  )}

  <div class="mt-4">
    <a href="/members/" class="btn btn-secondary">&larr; Back to Member Services</a>
  </div>
</BaseLayout>
